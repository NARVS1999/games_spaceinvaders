<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Invaders</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
        }
        .game-cell {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .alien {
            color: #4ade80; /* light green */
        }
        .player {
            color: #16a34a; /* nature green */
        }
        .bullet {
            color: #f59e0b;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen">
    <div class="text-center mb-8">
        <h1 class="text-4xl font-bold mb-4 text-green-700">SPACE INVADERS</h1>
        <div class="text-2xl mb-4">Score: <span id="score">0</span></div>
    </div>

    <div id="game-board" class="bg-white p-4 rounded-lg shadow-lg mb-8">
        <!-- Game grid will be generated by JavaScript -->
    </div>

    <div class="text-center text-sm text-gray-700 mb-8">
        <p>[SPACE] Shoot | [‚Üê][‚Üí] Move | [R] Reset</p>
    </div>

    <script>
        // Game constants
        const ROWS = 8;
        const COLS = 10;
        const CELL_TYPES = {
            EMPTY: '‚¨ú',
            ALIEN: 'üëæ',
            PLAYER: 'üöÄ',
            BULLET: '‚¨Ü'
        };

        // Game state
        let gameState = {
            grid: Array(ROWS).fill().map(() => Array(COLS).fill(CELL_TYPES.EMPTY)),
            playerPos: { row: ROWS - 1, col: Math.floor(COLS / 2) },
            aliens: [],
            bullets: [],
            score: 0,
            gameOver: false,
            alienDirection: 1, // 1 for right, -1 for left
            alienMoveInterval: 1000, // ms between alien moves
            lastAlienMove: 0
        };

        // Initialize the game
        function initGame() {
            // Clear the game board
            gameState.grid = Array(ROWS).fill().map(() => Array(COLS).fill(CELL_TYPES.EMPTY));
            
            // Reset player position
            gameState.playerPos = { row: ROWS - 1, col: Math.floor(COLS / 2) };
            gameState.grid[gameState.playerPos.row][gameState.playerPos.col] = CELL_TYPES.PLAYER;
            
            // Create aliens (3 rows of 10 aliens)
            gameState.aliens = [];
            for (let row = 0; row < 3; row++) {
                for (let col = 0; col < COLS; col++) {
                    gameState.aliens.push({ row, col });
                    gameState.grid[row][col] = CELL_TYPES.ALIEN;
                }
            }
            
            // Clear bullets
            gameState.bullets = [];
            
            // Reset score and game over state
            gameState.score = 0;
            document.getElementById('score').textContent = gameState.score;
            gameState.gameOver = false;
            
            // Reset alien movement
            gameState.alienDirection = 1;
            gameState.lastAlienMove = 0;
            
            renderGame();
        }

        // Render the game board
        function renderGame() {
            const gameBoard = document.getElementById('game-board');
            gameBoard.innerHTML = '';
            
            // Create rows
            for (let row = 0; row < ROWS; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'flex';
                
                // Create cells
                for (let col = 0; col < COLS; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'game-cell';
                    
                    // Set cell content based on game state
                    const cellContent = gameState.grid[row][col];
                    cell.textContent = cellContent;
                    
                    // Add classes for styling
                    if (cellContent === CELL_TYPES.ALIEN) {
                        cell.classList.add('alien');
                    } else if (cellContent === CELL_TYPES.PLAYER) {
                        cell.classList.add('player');
                    } else if (cellContent === CELL_TYPES.BULLET) {
                        cell.classList.add('bullet');
                    }
                    
                    rowDiv.appendChild(cell);
                }
                
                gameBoard.appendChild(rowDiv);
            }
        }

        // Move player
        function movePlayer(direction) {
            if (gameState.gameOver) return;
            
            const newCol = gameState.playerPos.col + direction;
            
            // Check bounds
            if (newCol >= 0 && newCol < COLS) {
                // Clear old position
                gameState.grid[gameState.playerPos.row][gameState.playerPos.col] = CELL_TYPES.EMPTY;
                
                // Update position
                gameState.playerPos.col = newCol;
                gameState.grid[gameState.playerPos.row][gameState.playerPos.col] = CELL_TYPES.PLAYER;
                
                renderGame();
            }
        }

        // Fire bullet
        function fireBullet() {
            if (gameState.gameOver) return;
            
            // Only allow one bullet at a time for simplicity
            if (gameState.bullets.length > 0) return;
            
            const bulletPos = {
                row: gameState.playerPos.row - 1,
                col: gameState.playerPos.col
            };
            
            gameState.bullets.push(bulletPos);
            gameState.grid[bulletPos.row][bulletPos.col] = CELL_TYPES.BULLET;
            
            renderGame();
        }

        // Update bullet positions
        function updateBullets() {
            if (gameState.gameOver) return;
            
            for (let i = gameState.bullets.length - 1; i >= 0; i--) {
                const bullet = gameState.bullets[i];
                
                // Clear current position
                gameState.grid[bullet.row][bullet.col] = CELL_TYPES.EMPTY;
                
                // Move bullet up
                bullet.row--;
                
                // Check if bullet hit top or hit an alien
                if (bullet.row < 0) {
                    // Remove bullet that went off screen
                    gameState.bullets.splice(i, 1);
                } else if (gameState.grid[bullet.row][bullet.col] === CELL_TYPES.ALIEN) {
                    // Hit an alien
                    const alienIndex = gameState.aliens.findIndex(
                        a => a.row === bullet.row && a.col === bullet.col
                    );
                    
                    if (alienIndex !== -1) {
                        // Remove alien
                        gameState.aliens.splice(alienIndex, 1);
                        gameState.grid[bullet.row][bullet.col] = CELL_TYPES.EMPTY;
                        
                        // Remove bullet
                        gameState.bullets.splice(i, 1);
                        
                        // Increase score
                        gameState.score += 100;
                        document.getElementById('score').textContent = gameState.score;
                        
                        // Check if all aliens are defeated
                        if (gameState.aliens.length === 0) {
                            alert('You Win! Final Score: ' + gameState.score);
                            gameState.gameOver = true;
                        }
                    }
                } else {
                    // Update bullet position
                    gameState.grid[bullet.row][bullet.col] = CELL_TYPES.BULLET;
                }
            }
            
            renderGame();
        }

        // Move aliens
        function moveAliens() {
            if (gameState.gameOver) return;
            
            let shouldDescend = false;
            
            // Check if any alien is at the edge
            for (const alien of gameState.aliens) {
                if ((alien.col === 0 && gameState.alienDirection === -1) || 
                    (alien.col === COLS - 1 && gameState.alienDirection === 1)) {
                    shouldDescend = true;
                    break;
                }
            }
            
            if (shouldDescend) {
                // Change direction and move down
                gameState.alienDirection *= -1;
                
                for (let i = gameState.aliens.length - 1; i >= 0; i--) {
                    const alien = gameState.aliens[i];
                    
                    // Clear old position
                    gameState.grid[alien.row][alien.col] = CELL_TYPES.EMPTY;
                    
                    // Move down
                    alien.row++;
                    
                    // Check if alien reached the bottom
                    if (alien.row >= ROWS - 1) {
                        gameOver();
                        return;
                    }
                    
                    // Update position
                    gameState.grid[alien.row][alien.col] = CELL_TYPES.ALIEN;
                }
            } else {
                // Move horizontally
                for (let i = gameState.aliens.length - 1; i >= 0; i--) {
                    const alien = gameState.aliens[i];
                    
                    // Clear old position
                    gameState.grid[alien.row][alien.col] = CELL_TYPES.EMPTY;
                    
                    // Move horizontally
                    alien.col += gameState.alienDirection;
                    
                    // Update position
                    gameState.grid[alien.row][alien.col] = CELL_TYPES.ALIEN;
                }
            }
            
            renderGame();
        }

        // Game over
        function gameOver() {
            gameState.gameOver = true;
            alert('Game Over! Final Score: ' + gameState.score);
        }

        // Game loop
        function gameLoop(timestamp) {
            if (!gameState.gameOver) {
                // Move aliens periodically
                if (timestamp - gameState.lastAlienMove > gameState.alienMoveInterval) {
                    moveAliens();
                    gameState.lastAlienMove = timestamp;
                }
                
                // Update bullets
                updateBullets();
            }
            
            requestAnimationFrame(gameLoop);
        }

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            switch (e.key) {
                case 'ArrowLeft':
                    movePlayer(-1);
                    break;
                case 'ArrowRight':
                    movePlayer(1);
                    break;
                case ' ':
                    fireBullet();
                    break;
                case 'r':
                case 'R':
                    initGame();
                    break;
            }
        });

        // Initialize and start the game
        initGame();
        requestAnimationFrame(gameLoop);
    </script>
</body>
</html>